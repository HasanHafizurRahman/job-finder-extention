(()=>{var B=(n,s)=>()=>(n&&(s=n(n=0)),s);var x=(n,s)=>()=>(s||n((s={exports:{}}).exports,s),s.exports);function b(n){return Promise.resolve(p("Uploaded file: "+(n.name||"file")))}function p(n){let s=(n||"").toLowerCase(),m=M.filter(u=>s.includes(u.toLowerCase())),l=s.match(/(\d+)\s+years?/);return{rawText:n,skills:m,yearsExperience:l?parseInt(l[1],10):null,probableTitle:(s.match(/frontend|developer|engineer|full[-\s]*stack/)||[""])[0]}}var M,E=B(()=>{M=["javascript","typescript","react","next.js","redux","tailwind","html","css","node.js","express","graphql","git","jest","webpack","vite","sass","mongodb","postgresql"]});var T=x(()=>{E();document.addEventListener("DOMContentLoaded",()=>{let n=document.getElementById("resumeText"),s=document.getElementById("resumeFile"),m=document.getElementById("saveProfileBtn"),l=document.getElementById("scrapeTabBtn"),u=document.getElementById("getSummaryBtn"),f=document.getElementById("jobsList"),w=document.getElementById("loader"),v=document.getElementById("jobCount"),y=document.getElementById("profilePreview"),h=document.getElementById("fileName");function g(t,r){t&&(t.disabled=r)}function L(t,r){t&&(t.hidden=r)}function o(t){L(w,!t),g(m,t),g(l,t),g(u,t)}function d(t){return t?String(t).replace(/[&<>"']/g,r=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[r]):""}function S(t){return t?String(t).replace(/"/g,"&quot;"):""}s&&h&&s.addEventListener("change",()=>{let t=s.files&&s.files[0];h.textContent=t?t.name:"No file selected"}),m&&m.addEventListener("click",async()=>{let t=s&&s.files&&s.files[0],r;try{t?r=await b(t):r=p(n&&n.value||"")}catch(e){return console.error("Error parsing resume:",e),alert("Error parsing resume: "+(e&&e.message?e.message:e))}o(!0),chrome.runtime.sendMessage({cmd:"SAVE_PROFILE",profile:r},e=>{var i;o(!1);let a=r.skills&&r.skills.length?r.skills.join(", "):"(none detected)",c=r.yearsExperience||"unknown";y?y.innerHTML=`<strong style="color:#fff">${d(r.probableTitle||"\u2014")}</strong><div style="font-size:11px;color:var(--muted)">${d(a)} \u2022 ${c} yrs</div>`:alert("Profile saved. Skills: "+a+`
Years exp: `+c);try{(i=navigator.vibrate)==null||i.call(navigator,10)}catch(k){}})}),l&&l.addEventListener("click",async()=>{let t=await chrome.tabs.query({active:!0,currentWindow:!0}),r=t&&t[0];if(!r)return alert("No active tab detected.");o(!0);try{await chrome.scripting.executeScript({target:{tabId:r.id},files:["contentScript.js"]})}catch(e){return console.error("Injection error:",e),o(!1),alert(`Could not inject content script automatically. Try refreshing the page and try again.
Error: `+(e&&e.message?e.message:e))}chrome.tabs.sendMessage(r.id,{cmd:"SCRAPE_JOBS_ON_PAGE"},e=>{if(o(!1),chrome.runtime.lastError)return console.warn("sendMessage error:",chrome.runtime.lastError),alert("Content script not present on this page. Try refreshing the page or check the page domain (see manifest).");alert("Scrape requested. Found "+(e.count||0)+" items (sent to storage).")})}),u&&u.addEventListener("click",()=>{o(!0),chrome.runtime.sendMessage({cmd:"GET_JOBS_SUMMARY"},t=>{o(!1);let r=t&&t.jobs||[];if(v&&(v.textContent=String(r.length||"0")),!r.length){f&&(f.innerHTML='<div class="empty">No jobs found \u2014 try scanning a jobs page first.</div>');return}f&&(f.innerHTML=""),r.slice(0,50).forEach(e=>{let a=document.createElement("div");a.className="job-card",a.innerHTML=`
            <div class="job-top">
              <div>
                <div class="job-title">${d(e.title)}</div>
                <div class="job-meta">${d(e.company)} \u2022 ${d(e.location||"")}${e.salary?" \u2022 "+d(e.salary):""}</div>
              </div>
              <div style="text-align:right">
                <div class="score-pill">${e.score}%</div>
              </div>
            </div>
            <div class="score-row">
              <div class="progress"><div class="progress-fill" data-score="${e.score}"></div></div>
            </div>
            <div class="job-links">
              <a class="open-link" href="${S(e.url)}" target="_blank" rel="noopener">Open</a>
              <a class="view-summary" href="#" data-summary>Summary</a>
            </div>
          `;let c=a.querySelector("[data-summary]");c&&c.addEventListener("click",i=>{if(i.preventDefault(),!e.summary)return alert("No summary available for this job.");alert(e.summary.length>1e3?e.summary.slice(0,1e3)+"\u2026":e.summary)}),a.addEventListener("click",i=>{if(!(i.target&&(i.target.matches("a")||i.target.closest("a")))&&e.url)try{window.open(e.url,"_blank")}catch(k){chrome.tabs.create({url:e.url})}}),f.appendChild(a)}),requestAnimationFrame(()=>{document.querySelectorAll(".progress-fill").forEach(e=>{let c=Math.max(0,Math.min(100,parseInt(e.dataset.score||"0",10)))*.9+Math.round(Math.random()*6);setTimeout(()=>e.style.width=`${c}%`,60+Math.random()*220)})})})})})});T();})();
